<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Petit Village — Démo HTML seule</title>
  <style>
    :root{
      --violet:#6b2fb3;
      --ui:#ffffff;
      --ui-shadow: rgba(0,0,0,.35);
    }
    html,body{
      height:100%;
      margin:0;
      background:var(--violet);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    }
    .wrap{
      display:grid;
      place-items:center;
      height:100%;
    }
    canvas{ 
      background: radial-gradient(1200px 800px at center, rgba(255,255,255,.06), rgba(255,255,255,0) 60%), var(--violet);
      box-shadow: 0 20px 60px rgba(0,0,0,.35), inset 0 0 0 2px rgba(255,255,255,.08);
      border-radius: 16px;
      image-rendering: pixelated;
      max-width: 96vw;
      max-height: 92vh;
    }
    .hud{
      position: fixed; inset: 16px auto auto 16px; color: var(--ui);
      text-shadow: 0 2px 6px var(--ui-shadow);
      user-select:none; font-size:14px; line-height:1.25;
    }
    .hud kbd{
      background: rgba(255,255,255,.18);
      border: 1px solid rgba(255,255,255,.35);
      padding: 2px 6px; border-radius: 6px;
      box-shadow: inset 0 1px 0 rgba(255,255,255,.35);
      margin-right:4px;
    }
    .prompt{
      position: fixed; left: 50%; bottom: 18px; transform: translateX(-50%);
      color: var(--ui); font-weight: 600; letter-spacing:.2px;
      padding: 8px 12px; border-radius: 10px;
      background: rgba(0,0,0,.35); border: 1px solid rgba(255,255,255,.35);
      display:none; white-space:nowrap; text-shadow:0 2px 6px var(--ui-shadow);
    }
  </style>
</head>
<body>
  <div class="wrap">
    <canvas id="game" width="960" height="600" aria-label="Village circulaire"></canvas>
  </div>
  <div class="hud" aria-hidden="true">
    <div><strong>Déplacements</strong> <kbd>Z</kbd><kbd>Q</kbd><kbd>S</kbd><kbd>D</kbd> ou <kbd>Flèches</kbd></div>
    <div><strong>Entrer</strong> <kbd>E</kbd> quand vous êtes devant une maison</div>
  </div>
  <div id="prompt" class="prompt">Appuyez sur <kbd>E</kbd> pour entrer</div>

  <script>
  const CONFIG = {
    world: { width: 960, height: 600 },
    center: { x: 480, y: 300 },
    circleRadius: 200,
    houseCount: 8, // ✅ 8 maisons
    house: {
      size: 80,
    },
    player: {
      size: 16,
      color: '#ffd166',
      outline: 'rgba(0,0,0,.45)',
      speed: 2.6,
      start: { x: 480, y: 300 },
    },
    links: {
      map: {
        1: "Excel Art.xlsx",
        2: "docs/maison2.xlsx",
        3: "docs/maison3.html",
        4: "docs/maison4.pdf",
        5: "docs/maison5.xlsx",
        6: "docs/maison6.html",
        7: "docs/maison7.pdf",
        8: "docs/maison8.xlsx"
      }
    }
  };

  // ✅ Tes 8 images PNG
  const HOUSE_IMAGES = [
    "http://www.image-heberg.fr/files/1756932846977872901.png",
    "http://www.image-heberg.fr/files/17569327082239331138.png",
    "http://www.image-heberg.fr/files/17569329301273083581.png",
    "http://www.image-heberg.fr/files/17569325061444124555.png",
    "http://www.image-heberg.fr/files/17569293553633849300.png",
    "http://www.image-heberg.fr/files/17569333324150026336.png",
    "http://www.image-heberg.fr/files/17569320932872336291.png",
    "http://www.image-heberg.fr/files/17569316144126423008.png"
  ];

  const canvas = document.getElementById('game');
  const ctx = canvas.getContext('2d');
  const prompt = document.getElementById("prompt");

  const TAU = Math.PI * 2;
  const clamp = (v,a,b)=>Math.max(a,Math.min(b,v));

  function generateHouses(){
    const houses=[];
    const {x:cx,y:cy}=CONFIG.center;
    const r=CONFIG.circleRadius;
    for(let i=0;i<CONFIG.houseCount;i++){
      const angle=(i/CONFIG.houseCount)*TAU - Math.PI/2;
      const hx=cx+Math.cos(angle)*r;
      const hy=cy+Math.sin(angle)*r;
      houses.push({
        id:i+1,
        x:hx, y:hy,
        w:CONFIG.house.size, h:CONFIG.house.size,
        img:new Image()
      });
      houses[i].img.src = HOUSE_IMAGES[i % HOUSE_IMAGES.length];
    }
    return houses;
  }

  const HOUSES = generateHouses();

  const keys=new Set();
  window.addEventListener('keydown',e=>keys.add(e.key.toLowerCase()));
  window.addEventListener('keyup',e=>keys.delete(e.key.toLowerCase()));

  const player={x:CONFIG.player.start.x,y:CONFIG.player.start.y,r:CONFIG.player.size};

  function tryMove(px,py){
    let dx=0,dy=0;
    if(keys.has('z')||keys.has('arrowup')) dy-=1;
    if(keys.has('s')||keys.has('arrowdown')) dy+=1;
    if(keys.has('q')||keys.has('arrowleft')) dx-=1;
    if(keys.has('d')||keys.has('arrowright')) dx+=1;
    const len=Math.hypot(dx,dy)||1;
    dx=dx/len*CONFIG.player.speed;
    dy=dy/len*CONFIG.player.speed;
    return {x:clamp(px+dx,player.r,CONFIG.world.width-player.r), y:clamp(py+dy,player.r,CONFIG.world.height-player.r)};
  }

  function drawHouse(h){
    ctx.drawImage(h.img, h.x - h.w/2, h.y - h.h/2, h.w, h.h);
  }

  function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    for(const h of HOUSES) drawHouse(h);
    ctx.beginPath();
    ctx.arc(player.x,player.y,player.r,0,TAU);
    ctx.fillStyle=CONFIG.player.color; ctx.fill();
    ctx.lineWidth=2; ctx.strokeStyle=CONFIG.player.outline; ctx.stroke();
  }

  // --- Détection proximité maison
  function getNearbyHouse() {
    for (const h of HOUSES) {
      const dist = Math.hypot(player.x - h.x, player.y - h.y);
      if (dist < CONFIG.house.size * 0.6) {
        return h;
      }
    }
    return null;
  }

  function updatePrompt() {
    const h = getNearbyHouse();
    if (h && CONFIG.links.map[h.id]) {
      prompt.style.display = "block";
    } else {
      prompt.style.display = "none";
    }
  }

  // --- Entrer dans la maison
  window.addEventListener("keydown", e => {
    if (e.key.toLowerCase() === "e") {
      const h = getNearbyHouse();
      if (h && CONFIG.links.map[h.id]) {
        window.location.href = CONFIG.links.map[h.id];
      }
    }
  });

  function loop(){
    const next=tryMove(player.x,player.y);
    player.x=next.x; player.y=next.y;
    draw();
    updatePrompt();
    requestAnimationFrame(loop);
  }
  loop();
  </script>
</body>
</html>
